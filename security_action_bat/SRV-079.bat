@echo off
setlocal

set "TMP1=%~n0.log"
> "%TMP1%"

echo 코드 [SRV-079] 익명 사용자에게 부적절한 권한 적용 >> "%TMP1%"
echo [양호]: 익명 사용자에게 부적절한 권한이 적용되지 않음 >> "%TMP1%"
echo [취약]: 익명 사용자에게 부적절한 권한이 적용됨 >> "%TMP1%"

:: 권한 확인을 위한 자리 표시자 - 실제 확인은 PowerShell로 수행해야 함
echo 이 스크립트는 "모두" 그룹에 대해 잠재적으로 허용적인 ACL을 식별하는 방법을 보여줍니다. >> "%TMP1%"
echo 정확한 권한 확인을 위해서는 ACL을 상세히 분석할 수 있는 PowerShell 스크립트 사용을 고려하세요. >> "%TMP1%"

:: 특정 디렉터리의 권한 나열 예제 (경로는 필요에 따라 조정하세요)
echo 디렉터리 C:\ExamplePath의 권한을 나열합니다: >> "%TMP1%"
icacls "C:\ExamplePath" >> "%TMP1%"

:: 이것은 원본 스크립트에서처럼 "세계 쓰기 가능" 권한을 직접 확인하지 않습니다.
:: ACL을 나열한 다음, 허용적인지 수동으로 검토할 수 있습니다.

:: 결과 표시
type "%TMP1%"

echo.
echo 스크립트 완료.
